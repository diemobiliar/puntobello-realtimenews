{"version":3,"file":"RealTimeNewsFeedWebPart.js","sourceRoot":"","sources":["../../../src/webparts/realTimeNewsFeed/RealTimeNewsFeedWebPart.ts"],"names":[],"mappings":"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","sourcesContent":["// React and ReactDOM imports for building and rendering components\nimport * as React from 'react';\nimport * as ReactDom from 'react-dom';\n\n// SPFx component base and web part imports for theming and client-side web part functionalities\nimport { ThemeProvider, ThemeChangedEventArgs, IReadonlyTheme } from '@microsoft/sp-component-base';\nimport { BaseClientSideWebPart } from \"@microsoft/sp-webpart-base\";\nimport { Version } from '@microsoft/sp-core-library';\nimport { IPropertyPaneConfiguration } from \"@microsoft/sp-property-pane\";\n\n// PnP SPFx property control for number inputs in the property pane\nimport { PropertyFieldNumber } from '@pnp/spfx-property-controls/lib/PropertyFieldNumber';\n\n// Importing localization strings and lodash utility library\nimport * as strings from 'realTimeNewsFeedStrings';\nimport * as __ from 'lodash';\n\n// Component imports for the RealTimeNewsFeed and context management\nimport { RealTimeNewsFeed } from './components/RealTimeNewsFeed';\nimport { AppContext, AppContextProvider } from './contexts/AppContext';\n\n// Service and utility imports for logging and SharePoint interactions\nimport { Logger } from './utils/logger';\nimport SharePointService from './services/SharePointService';\n\n// Model imports for defining types and interfaces\nimport { ILanguageRepresentation } from './models';\n\n\nexport interface IRealTimeNewsFeedWebPartProps {\n  newsCount: number;\n}\n\nexport default class RealTimeNewsFeedWebPart extends BaseClientSideWebPart<IRealTimeNewsFeedWebPartProps> {\n  private logger!: Logger;\n  private pageLanguage!: ILanguageRepresentation;\n  private themeProvider!: ThemeProvider;\n  private themeVariant: IReadonlyTheme | undefined;\n  private initialized: boolean = false;\n\n  private _handleThemeChangedEvent(args: ThemeChangedEventArgs): void {\n    this.themeVariant = args.theme;\n    this.render();\n  }\n\n  protected async onInit(): Promise<void> {\n    this.logger = Logger.getInstance();\n    this.logger.setContextInfo(this.context.manifest.alias + \" with id \" + this.context.manifest.id);\n    this.logger.info('Logger initialized');\n\n    try {\n      // Make wp theme aware\n      this.themeProvider = this.context.serviceScope.consume(ThemeProvider.serviceKey);\n      this.themeVariant = this.themeProvider.tryGetTheme();\n      this.themeProvider.themeChangedEvent.add(this, this._handleThemeChangedEvent);\n      const listId = this.context.pageContext.list?.id.toString() ?? '';\n      const listItemId = this.context.pageContext.listItem?.id ?? 0;\n      const language = this.context.pageContext.web.language;\n\n      await super.onInit();\n\n      const spo = this.context.serviceScope.consume(SharePointService.serviceKey);\n\n      // Set the full SPFx context on the SharePoint service\n      // This is required for PnP v4 to work correctly with authentication\n      spo.setContext(this.context);\n\n      this.pageLanguage = await spo.calculateLanguage(listId, listItemId, language);\n      this.initialized = true;\n\n    } catch (error) {\n      this.logger.error(\"Error in onInit Webpart: \", error);\n    }\n  }\n\n  public render(): void {\n    if(this.initialized) {\n      const appContext = new AppContext(\n        this.context,\n        this.logger,\n        this.pageLanguage,\n        this.themeVariant!,\n        this.properties.newsCount\n      );\n  \n      const element: React.ReactElement = React.createElement(\n        AppContextProvider,\n        { appContext },\n        React.createElement(RealTimeNewsFeed)\n      );\n      ReactDom.render(element, this.domElement);\n  \n    }\n  }\n\n  protected onDispose(): void {\n    ReactDom.unmountComponentAtNode(this.domElement);\n  }\n\n  protected get dataVersion(): Version {\n    return Version.parse('1.0');\n  }\n\n  protected get disableReactivePropertyChanges(): boolean {\n    return true;\n  }\n\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\n    return {\n      pages: [\n        {\n          header: {\n            description: strings.PropertyPaneDescription\n          },\n          groups: [\n            {\n              groupName: strings.BasicGroupName,\n              groupFields: [\n                PropertyFieldNumber(\"newsCount\", {\n                  key: \"newsCount\",\n                  label: strings.newsCountLabel,\n                  description: strings.newsCountDesc,\n                  value: this.properties.newsCount,\n                  maxValue: 24,\n                  minValue: 1,\n                  disabled: false\n                })\n              ]\n            }\n          ]\n        }\n      ]\n    };\n  }\n}\n\n"]}